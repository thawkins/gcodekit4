/// Device Console Panel Component
/// Displays device console output with clear and copy buttons

import { Button, TextEdit, LineEdit, VerticalBox, HorizontalBox, ScrollView } from "std-widgets.slint";

export component DeviceConsolePanel inherits VerticalBox {
    spacing: 5px;
    padding: 10px;
    horizontal-stretch: 1.0;
    vertical-stretch: 1.0;
    
    in property <string> console-output: "";
    in property <bool> connected: false;
    in-out property <string> command-input: "";
    
    callback console-clear-clicked();
    callback console-copy-clicked();
    callback send-command(string);
    
    HorizontalBox {
        spacing: 5px;
        
        Button {
            text: "Clear";
            clicked => {
                root.console-clear-clicked();
            }
        }
        
        Button {
            text: "Copy";
            clicked => {
                root.console-copy-clicked();
            }
        }
    }
    
    ScrollView {
        VerticalBox {
            padding: 5px;
            alignment: start;
            horizontal-stretch: 1.0;
            vertical-stretch: 1.0;
            
            Text {
                text: root.console-output;
                color: #000000;
                wrap: word-wrap;
            }
        }
    }
    
    // Command input at bottom
    HorizontalBox {
        spacing: 5px;
        padding-top: 5px;
        
        Text {
            text: "Command:";
            vertical-alignment: center;
            width: 70px;
        }
        
        cmd-input := LineEdit {
            text <=> root.command-input;
            placeholder-text: "Enter command (e.g., $I, G0 X10, ?)";
            enabled: root.connected;
            horizontal-stretch: 1.0;
            
            accepted => {
                if (self.text != "") {
                    root.send-command(self.text);
                    self.text = "";
                }
            }
        }
        
        Button {
            text: "Send";
            enabled: root.connected && root.command-input != "";
            clicked => {
                if (root.command-input != "") {
                    root.send-command(root.command-input);
                    root.command-input = "";
                }
            }
        }
    }
}
