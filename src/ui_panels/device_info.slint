/// Device Information Panel
/// Display firmware type, version, and capabilities when device is connected

import { Button, VerticalBox, HorizontalBox, ScrollView, GridBox } from "std-widgets.slint";

export struct CapabilityItem {
    name: string,
    enabled: bool,
    notes: string,
}

export component DeviceInfoPanel inherits VerticalBox {
    spacing: 10px;
    padding: 15px;
    
    in property <bool> connected: false;
    in property <string> firmware-type: "";
    in property <string> firmware-version: "";
    in property <string> device-name: "";
    in property <[CapabilityItem]> capabilities: [];
    
    // Not connected state
    if !root.connected: VerticalBox {
        alignment: center;
        
        Rectangle {
            height: 200px;
            
            VerticalBox {
                alignment: center;
                spacing: 20px;
                
                Text {
                    text: "ðŸ“¡";
                    font-size: 64px;
                    horizontal-alignment: center;
                }
                
                Text {
                    text: "No Device Connected";
                    font-size: 20px;
                    font-weight: 600;
                    color: #7f8c8d;
                    horizontal-alignment: center;
                }
                
                Text {
                    text: "Please connect a device to view firmware information and capabilities";
                    font-size: 14px;
                    color: #95a5a6;
                    horizontal-alignment: center;
                }
            }
        }
    }
    
    // Connected state
    if root.connected: ScrollView {
        VerticalBox {
            spacing: 20px;
            
            // Device Information Section
            Rectangle {
                background: #ecf0f1;
                border-radius: 8px;
                
                VerticalBox {
                    padding: 15px;
                    spacing: 10px;
                    
                    Text {
                        text: "Device Information";
                        font-size: 16px;
                        font-weight: 700;
                        color: #2c3e50;
                    }
                    
                    Rectangle {
                        height: 1px;
                        background: #bdc3c7;
                    }
                    
                    // Device Name
                    HorizontalBox {
                        spacing: 10px;
                        
                        Text {
                            text: "Device Name:";
                            font-weight: 600;
                            color: #34495e;
                            width: 150px;
                        }
                        
                        Text {
                            text: root.device-name;
                            color: #2c3e50;
                            horizontal-stretch: 1;
                        }
                    }
                    
                    // Firmware Type
                    HorizontalBox {
                        spacing: 10px;
                        
                        Text {
                            text: "Firmware Type:";
                            font-weight: 600;
                            color: #34495e;
                            width: 150px;
                        }
                        
                        Text {
                            text: root.firmware-type;
                            color: #27ae60;
                            font-weight: 600;
                            horizontal-stretch: 1;
                        }
                    }
                    
                    // Firmware Version
                    HorizontalBox {
                        spacing: 10px;
                        
                        Text {
                            text: "Firmware Version:";
                            font-weight: 600;
                            color: #34495e;
                            width: 150px;
                        }
                        
                        Text {
                            text: root.firmware-version;
                            color: #3498db;
                            font-weight: 600;
                            horizontal-stretch: 1;
                        }
                    }
                }
            }
            
            // Capabilities Section
            Rectangle {
                background: #ecf0f1;
                border-radius: 8px;
                
                VerticalBox {
                    padding: 15px;
                    spacing: 10px;
                    
                    Text {
                        text: "Firmware Capabilities";
                        font-size: 16px;
                        font-weight: 700;
                        color: #2c3e50;
                    }
                    
                    Rectangle {
                        height: 1px;
                        background: #bdc3c7;
                    }
                    
                    // Capabilities Grid
                    VerticalBox {
                        spacing: 5px;
                        
                        for capability[index] in root.capabilities: Rectangle {
                            height: 35px;
                            background: Math.mod(index, 2) == 0 ? #ffffff : #f8f9fa;
                            border-radius: 4px;
                            
                            HorizontalBox {
                                padding: 8px;
                                spacing: 10px;
                                
                                // Status icon
                                Text {
                                    text: capability.enabled ? "âœ“" : "âœ—";
                                    color: capability.enabled ? #27ae60 : #e74c3c;
                                    font-size: 16px;
                                    font-weight: 700;
                                    width: 25px;
                                    vertical-alignment: center;
                                }
                                
                                // Capability name
                                Text {
                                    text: capability.name;
                                    color: capability.enabled ? #2c3e50 : #95a5a6;
                                    font-weight: 500;
                                    width: 200px;
                                    vertical-alignment: center;
                                }
                                
                                // Notes
                                Text {
                                    text: capability.notes;
                                    color: #7f8c8d;
                                    font-size: 12px;
                                    horizontal-stretch: 1;
                                    vertical-alignment: center;
                                    overflow: elide;
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}
